<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>用户登录</title>
<link rel="stylesheet" href="dist/css/zui.min.css">
<link rel="stylesheet" media="screen" href="css/style.css">
</head>

<body>
	<div id="particles-js"></div>
	<div class="panel" id="main-content">
		<div class="panel-heading"
			style="text-align: center; font-size: 18px; font-weight: bold;">
			用户登录</div>
		<div class="panel-body">
			<div class="input-group with-padding">
				<span class="input-group-addon">用户</span> <input type="text"
					name="userName" id="userName" class="form-control"
					placeholder="请输入用户">
			</div>
			<div class="input-group with-padding">
				<span class="input-group-addon">密码</span> <input type="password"
					name="password" id="password" class="form-control"
					placeholder="请输入密码">
			</div>
			<div class="input-group with-padding">
				<span class="input-group-addon">验证码</span> <input type="text"
					name="code" id="code" class="form-control" placeholder="请输入验证码">
				<span class="input-group-addon fix-border fix-padding"></span> <img
					src="image.act" id="imageCode" onclick="getCode()"
					class="form-control">
			</div>
			<div class="with-padding">
				<button class="btn btn-block  btn-primary" onclick="login()"
					type="button">登录</button>
			</div>
			<div class="with-padding">
				<button class="btn btn-block  btn-primary"
					onclick="registerBefore()" type="button">注册</button>
			</div>
		</div>
		<!-- 新增对话框 -->
		<div id="addModal" class="modal fade">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">
							<span aria-hidden="true">×</span><span class="sr-only">关闭</span>
						</button>
						<h4 class="modal-title" style="text-align: center;">用户注册</h4>
					</div>
					<div class="modal-body" style="padding: 0">
						<div class="col-xs-12  with-padding" style="margin-top: 12px;">
							<div class="input-group with-padding">
								<span class="input-group-addon">用户名</span> <input name="adduserName" id="adduserName"
									type="text" class="form-control" placeholder="请输入用户名">
							</div>
							<div class="input-group with-padding">
								<span class="input-group-addon">昵称</span> <input type="text"
									name="adduserNiName" id="adduserNiName" class="form-control"
									placeholder="请输入昵称">
							</div>
							<div class="input-group with-padding">
								<span class="input-group-addon">密码</span> <input id="addPwd" name="addPwd"
									type="password" class="form-control" placeholder="请输入密码">
							</div>
							<div class="input-group with-padding">
								<span class="input-group-addon">确认密码</span> <input
									type="password" name="addrePwd" id="addrePwd"
									class="form-control" placeholder="请输入确认密码">
							</div>
							<div class="input-group with-padding">
								<span class="input-group-addon">性别</span> <select
									class="form-control" name="adduserSex" id="adduserSex">
									<option value="0">请选择性别</option>
									<option value="1">男</option>
									<option value="2">女</option>
								</select>
							</div>
							<div class="input-group with-padding">
								<span class="input-group-addon">学历</span> <select
									class="form-control" name="adduserEdu" id="adduserEdu">
									<option value="0">请选择学历</option>
									<option value="大专">大专</option>
									<option value="本科">本科</option>
									<option value="研究生">研究生</option>
									<option value="博士">博士</option>
								</select>
							</div>
							<div class="input-group with-padding">
								<span class="input-group-addon">职业</span> <select
									class="form-control" name="adduserPro" id="adduserPro">
									<option value="0">请选择职业</option>
									<option value="学生">学生</option>
									<option value="教师">教师</option>
									<option value="医生">医生</option>
									<option value="警察">警察</option>
									<option value="程序员">程序员</option>
									<option value="公务员">公务员</option>
									<option value="自由职业者">自由职业者</option>
								</select>
							</div>
							<div class="input-group with-padding">
								<span class="input-group-addon">手机号</span> <input type="tel"
									name="adduserTel" id="adduserTel" class="form-control"
									placeholder="请输入手机号">
							</div>
							<div class="input-group with-padding">
								<span class="input-group-addon">Email</span> <input type="email"
									name="adduserEmail" id="adduserEmail" class="form-control"
									placeholder="请输入邮箱">
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
						<button type="button" class="btn btn-primary" onclick="register()">保存</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- scripts -->
	<script src="js/particles.js"></script>
	<script src="js/app.js"></script>

	<!-- stats.js -->
	<script src="js/lib/stats.js"></script>
	<script>
		var count_particles, stats, update;
		stats = new Stats;
		stats.setMode(0);
		stats.domElement.style.position = 'absolute';
		stats.domElement.style.left = '0px';
		stats.domElement.style.top = '0px';
		document.body.appendChild(stats.domElement);
		count_particles = document.querySelector('.js-count-particles');
		update = function() {
			stats.begin();
			stats.end();
			requestAnimationFrame(update);
		};
		requestAnimationFrame(update);
	</script>
</body>
<script src="dist/lib/jquery/jquery.js"></script>
<script src="dist/js/zui.min.js"></script>
<script type="text/javascript">
	function register() {
		var $adduserName = $("#adduserName");
		var $adduserNiName = $("#adduserNiName");
		var $addPwd = $("#addPwd");
		var $addrePwd = $("#addrePwd");
		var $adduserSex = $("#adduserSex");
		var $adduserEdu = $("#adduserEdu");
		var $adduserPro = $("#adduserPro");
		var $adduserEmail = $("#adduserEmail");
		var $adduserTel = $("#adduserTel");
		if ($adduserName.val() == "") {
			alert("用户名不得为空!");
		} else if ($adduserNiName.val() == "") {
			alert("昵称不得为空!");
		} else if ($addPwd.val() == "") {
			alert("密码不得为空!");
		} else if ($addrePwd.val() == "") {
			alert("确认密码不得为空!");
		} else if ($adduserSex.val() == 0) {
			alert("请选择性别!");
		} else if ($adduserEdu.val() == 0) {
			alert("请选择学历!");
		} else if ($adduserPro.val() == 0) {
			alert("请选择职业!");
		} else if ($adduserTel.val() == "") {
			alert("电话不得为空!");
		} else if ($adduserEmail.val() == "") {
			alert("邮箱不得为空!");
		} else if ($addPwd.val() != $addrePwd.val()) {
			alert("确认密码与密码不匹配!");
		} else {
			$.ajax({
				url : "userRegister.act",
				type : "post",
				data : {
					"adduserName" : $adduserName.val(),
					"adduserNiName" : $adduserNiName.val(),
					"addPwd" : $addPwd.val(),
					"adduserSex" : $adduserSex.val(),
					"adduserEdu" : $adduserEdu.val(),
					"adduserPro" : $adduserPro.val(),
					"adduserEmail" : $adduserEmail.val(),
					"adduserTel" : $adduserTel.val()
				},
				async : true,
				dataType : "JSON",
				success : function(data) {
					if (data.id == 1) {
						window.alert(data.msg);
						//清空输入框
						$adduserName.val("");
						 $adduserNiName.val("");
						 $addPwd.val("");
						 $addrePwd.val("");
						 $adduserSex.val(0);
						 $adduserEdu.val(0);
						 $adduserPro.val(0);
						 $adduserEmail.val("");
						 $adduserTel.val("");
						 //保存隐藏
						$('#addModal').modal('hide', 'fit');
					} else if (data.id == 2) {
						window.alert(data.msg);
					}
				},
				error : function(data) {
					alert("出错啦");
				}
			})
		}
	}
	function getCode() {
		var image = document.getElementById("imageCode");
		image.src = "image.act?" + Math.random();
	}
	function registerBefore() {//展示注册页面
		$('#addModal').modal({
			show : true,
			backdrop : 'static'
		});
	}

	function login() {
		var $userName = $("#userName");
		var $password = $("#password");
		var $code = $("#code");
		if ($userName.val() == "") {
			alert("用户名不得为空!");
		} else if ($password.val() == "") {
			alert("密码不得为空!");
		} else if ($code.val() == "") {
			alert("验证码不得为空!");
		} else {
			$.ajax({
				url : "userLogin.act",
				type : "post",
				data : {
					"userName" : $userName.val(),
					"password" : $password.val(),
					"code" : $code.val()
				},
				async : true,
				dataType : "JSON",
				success : function(data) {
					if (data.id == 1 || data.id == 2 || data.id == 4) {
						window.alert(data.msg);
						getCode();
					} else if (data.id == 3) {
						window.alert(data.msg);
						window.location.href = "page.act?page=" + data.location
								+ "&login=" + Math.random();
					}
				},
				error : function(data) {
					alert("出错啦");
				}
			})
		}
	}
</script>
</html>